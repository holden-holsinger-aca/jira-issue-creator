# Jira Issue Creator

A Python script to bulk create Jira issues from Excel spreadsheets, with AI-powered ticket enhancement using local LLM (Ollama). Automatically creates parent epics and links child issues with rich descriptions and acceptance criteria.

## Features

- Extract issue data from Excel files
- **AI-Enhanced Tickets**: Automatically generate detailed descriptions and acceptance criteria using local LLM (Ollama)
- Create parent epic automatically
- Link child issues to parent epic
- Support for custom fields (Initiative field)
- No cloud API keys required - runs completely locally

## Prerequisites

1. **Ollama** (for AI ticket enhancement):
   - Install from https://ollama.com/download
   - Pull the model: `ollama pull phi3`
   - Verify: `ollama run phi3 "test"`

2. **Python 3.9+**

## Setup

1. Clone the repository
2. Create a virtual environment: `python -m venv venv`
3. Activate it: `venv\Scripts\activate` (Windows) or `source venv/bin/activate` (Mac/Linux)
4. Install dependencies: `pip install openpyxl requests ollama`
5. Set environment variable for Jira token: `set jira_token=YOUR_API_TOKEN` (Windows)
6. Update `config.py` with your Jira instance details

## Usage

1. Prepare an Excel file `tickets_to_create.xlsx` with columns:
   - Column A: issuetype (5 for Epic, 6 for Story)
   - Column B: project (e.g., GRW)
   - Column C: summary (issue title)
   - Column D: description (optional - will be enhanced by LLM)
   - Column E: acceptance_criteria (optional - will be generated by LLM)

2. **Optional**: Customize the LLM template at `template.txt`

3. Run the script:
   ```bash
   python script.py
   ```

The script will:
1. Read summaries from Excel
2. Use local AI (Ollama) to generate rich descriptions and acceptance criteria
3. Create the parent epic in Jira
4. Create child issues with AI-enhanced content linked to the epic

## How It Works

1. **Excel Parsing** ([excel.py](excel.py)): Extracts ticket data from spreadsheet
2. **AI Enhancement** ([ticket_generator.py](ticket_generator.py)): Sends summaries to local Ollama LLM to generate:
   - User stories in standard format
   - Detailed acceptance criteria (4-7 bullet points)
3. **Jira Creation** ([script.py](script.py)): Creates tickets via Jira REST API with enhanced content

## Files

- `script.py` - Main orchestration and integration
- `add_issue.py` - Jira API request handler
- `excel.py` - Excel file parser
- `config.py` - Configuration and credentials
- `ticket_generator.py` - Local LLM integration for ticket enhancement
- `template.txt` - Prompt template for LLM
- `documentation/` - Additional setup guides and reference materials
- `tickets_to_create.xlsx` - Input data file

## Requirements

- Python 3.9+
- openpyxl (Excel file handling)
- requests (HTTP API calls)
- ollama (Local LLM client)
- Ollama application with phi3 model installed

## Advanced Configuration

### Using a Different LLM Model

Set environment variable before running:
```bash
set OLLAMA_MODEL=mistral  # Windows
export OLLAMA_MODEL=mistral  # Mac/Linux
```

### Customizing Ticket Templates

Edit `template.txt` in the root folder to change:
- Output format structure
- Acceptance criteria count/style
- User story format

### Skipping LLM Enhancement

If you want to use Excel data as-is without AI enhancement:

1. Open [script.py](script.py)
2. Change `generate_details = True` to `generate_details = False`
3. Run the script

The script will create tickets using only the description and acceptance criteria from your Excel file, bypassing the AI generation step entirely.

## Troubleshooting

- **Ollama not found**: Ensure Ollama is installed and `ollama run phi3 "test"` works
- **LLM generation fails**: Script continues with Excel data; check Ollama service is running
- **API authentication errors**: Verify `jira_token` environment variable is set correctly
- **Import errors**: Run `pip install openpyxl requests ollama`

For detailed Ollama setup, see `documentation/README-generator_setup.md`
